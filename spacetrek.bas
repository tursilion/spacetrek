100 RANDOMIZE
110 OPTION BASE 1
120 DIM DA(7),XA(9),YA(9),SF(10)
130 DIM EX(20),EY(20),BX(8),BY(8),PX(5),PY(5),PS(5),SX(7),SY(7)
140 DIM HX(2),HY(2)
150 SP=0
160 D=5
170 SH=0
180 F=1
190 TI=-1
200 DL=20
210 P=100000
220 T=10
230 FOR A=1 TO 7
240 DA(A)=0
250 NEXT A
260 X=50
270 Y=50
280 CR=100
290 FOR A=1 TO 20
300 EX(A)=INT(RND*100)+1
310 EY(A)=INT(RND*100)+1
320 NEXT A
330 FOR A=1 TO 5
340 PX(A)=INT(RND*100)+1
350 PY(A)=INT(RND*100)+1
360 PS(A)=INT(RND*2)
370 NEXT A
380 CALL CHAR(97,"0000004FE43C")
390 FOR A=1 TO 7
400 SX(A)=INT(RND*100)+1
410 SY(A)=INT(RND*100)+1
420 NEXT A
421 FOR A=1 TO 8
422 BX(A)=INT(RND*100)+1
423 BY(A)=INT(RND*100)+1
424 NEXT A
430 CALL CHAR(98,"00001038FEFE")
440 FOR A=1 TO 2
450 HX(A)=INT(RND*100)+1
460 HY(A)=INT(RND*100)+1
470 NEXT A
480 FOR A=1 TO 9
490 READ XA(A),YA(A)
500 NEXT A
510 CALL CHAR(100,"3C6681BDA5BD817E")
520 CALL CHAR(101,"003CFFFFFFFF3C")
530 CALL CHAR(102,"AA3DC243C243BC55")
540 CALL CHAR(103,"7EC3A59999A5C37E")
550 CALL CLEAR
560 PRINT "     SPACE TREK": : : : : :"PRESS ANY KEY TO START"
570 CALL KEY(0,K,S)
580 IF S=0 THEN 570
590 IF K<>ASC("I")THEN 600
600 CALL CLEAR
610 INPUT "WHAT IS YOUR NAME? ":N$
620 PRINT "WELCOME ABOARD ";N$: :
630 PRINT "WHAT ARE YOUR ORDERS, ";N$;
640 INPUT CO
650 IF (CO>0)*(CO<15)THEN 680
660 PRINT "ORDERS ARE NUMBERED 1-14, ";N$
670 GOTO 630
680 ON CO GOTO 700,890,970,1200,1640,2020,2130,2250,2920,3040,3300,3410,3560,6000
690 DATA -1,-1,0,-1,1,-1,-1,0,0,0,1,0,-1,1,0,1,1,1
700 REM 
710 IF SGN(DA(1))<>-1 THEN 750
720 PRINT "ENGINES ARE DAMAGED ";N$
730 PRINT
740 GOTO 630
750 PRINT "ENGINES AT WARP";SP;",";N$
760 INPUT "NEW SPEED (0-8) ":SP
770 IF (SP>=0)*(SP<9)THEN 870
780 IF SP>8 THEN 830
790 SP=0
800 PRINT "IF YOU WANT TO GO BACKWARDS,TURN AROUND ";N$;"!"
810 PRINT
820 GOTO 630
830 PRINT "WE CAN'T GO THAT FAST ";N$
840 PRINT
850 SP=0
860 GOTO 630
870 PRINT "RIGHT! WARP";SP;N$
880 GOTO 3560
890 REM  
900 IF SGN(DA(1))=-1 THEN 720
910 PRINT "WE ARE GOING DIRECTION #";D
920 INPUT "NEW DIRECTION (1-9) ":D
930 IF (D<1)+(D>9)THEN 920
940 PRINT "ALL DONE ";N$:"POWER LOSS=";SP
950 P=P-SP
960 GOTO 3560
970 REM 
980 IF SGN(DA(7))<>-1 THEN 1010
990 PRINT "COMMUNICATION LINES ARE OUT ";N$
1000 GOTO 630
1010 PRINT "STATUS"
1020 PRINT "DINGDONS LEFT:";DL
1030 PRINT "POWER LEFT:";P
1040 PRINT "PHOTON TORPEDOS LEFT:";T
1050 PRINT "CREW LEFT:";CR
1060 PRINT "SPEED: WARP";SP
1070 PRINT "DIRECTION:";D
1080 PRINT "POSITION:";X;Y
1090 PRINT "SHIELDS:";SH
1100 PRINT "PHASORS:";F
1110 IF TI<0 THEN 1130
1120 PRINT "TIME UNTIL HELP ARRIVES:";TI
1130 PRINT :"DAMAGE"
1140 PRINT "ENGINES",DA(1),"TELEPORT",DA(2),"SENSORS",DA(3),"SHIELD",DA(4),"PHASOR",DA(5),"TORPEDO",DA(6)
1150 PRINT "COMMUNICATION",DA(7)
1160 PRINT
1170 P=P-1
1180 INPUT "ENTER TO GO ON...":A$
1190 GOTO 630
1200 REM  
1210 IF SGN(DA(2))<>-1 THEN 1240
1220 PRINT "TELEPORTER IS DAMAGED, ";N$
1230 GOTO 630
1240 IR=0
1250 FOR A=1 TO 20
1260 IF EX(A)=-1 THEN 1310
1270 IF (ABS(EX(A)-X)>2)+(ABS(EY(A)-Y)>2)THEN 1310
1280 IR=IR+1
1290 IF IR>10 THEN 1310
1300 SF(IR)=A
1310 NEXT A
1320 IF IR>0 THEN 1350
1330 PRINT "NO SHIPS IN RANGE ";N$
1340 GOTO 630
1350 PRINT IR;"SHIPS IN RANGE ";N$
1360 INPUT "SEND HOW MANY MEN?":NM
1370 L=0
1380 IF C-NM>=20 THEN 1420
1390 FOR A=1 TO IR
1400 PRINT "YOU MUST LEAVE AT LEAST 20  MEN ";N$
1410 GOTO 630
1420 IF NM=0 THEN 630
1430 P=P-MN*10
1440 C=C-NM
1450 IF NM/IR>=INT(RND*(10*IR))THEN 1490
1460 NM=0
1470 PRINT "MISSION FAILED. ALL MEN LOST"
1480 GOTO 3560
1490 PRINT "MISSION SUCCESSFUL"
1500 IF IR<11 THEN 1520
1510 IR=10
1520 FOR A=1 TO IR
1530 DL=DL-1
1540 EX(SF(A))=-1
1550 NEXT A
1560 IF RND>.15 THEN 1580
1570 L=L+INT(RND*(NM-L))
1580 NEXT A
1590 PRINT IR;"SHIPS DESTROYED"
1600 PRINT L;"MEN LOST ";N$
1610 MN=MN-L
1620 C=C+MN
1630 GOTO 3560
1640 REM 
1650 IF SGN(DA(3))<>-1 THEN 1680
1660 PRINT "SENSORS ARE DAMAGED ";N$
1670 GOTO 630
1680 INPUT "OPTION 1 OR 2?":A
1681 IF (A<>1)*(A<>2)THEN 1680
1690 CALL CLEAR
1700 CALL HCHAR(2,5,43,22)
1710 CALL HCHAR(23,5,43,22)
1720 CALL VCHAR(2,5,43,22)
1730 CALL VCHAR(2,27,43,22)
1741 IF A=1 THEN 1745
1742 GOSUB 7000
1743 GOTO 2000
1745 CALL HCHAR(12,16,97)
1750 FOR A=1 TO 20
1760 IF EX(A)=-1 THEN 1790
1770 IF (ABS(EY(A)-Y)>10)+(ABS(EX(A)-X)>10)THEN 1790
1780 CALL HCHAR(12+(EY(A)-Y),16+(EX(A)-X),98)
1790 NEXT A
1800 FOR A=1 TO 8
1810 IF BX(A)=-1 THEN 1840
1820 IF (ABS(BY(A)-Y)>10)+(ABS(BX(A)-X)>10)THEN 1840
1830 CALL HCHAR(12+(BY(A)-Y),16+(BX(A)-X),100)
1840 NEXT A
1850 FOR A=1 TO 5
1860 IF PX(A)=-1 THEN 1890
1870 IF (ABS(PY(A)-Y)>10)+(ABS(PX(A)-X)>10)THEN 1890
1880 CALL HCHAR(12+(PY(A)-Y),16+(PX(A)-X),101)
1890 NEXT A
1900 FOR A=1 TO 7
1910 IF SX(A)=-1 THEN 1940
1920 IF (ABS(SY(A)-Y)>10)+(ABS(SX(A)-X)>10)THEN 1940
1930 CALL HCHAR(12+(SY(A)-Y),16+(SX(A)-X),102)
1940 NEXT A
1950 FOR A=1 TO 2
1960 IF (ABS(HY(A)-Y)>10)+(ABS(HX(A)-X)>10)THEN 1980
1970 CALL HCHAR(12+(HY(A)-Y),16+(HX(A)-X),103)
1980 NEXT A
1990 P=P-10
2000 INPUT "ENTER TO GO ON...":A$
2010 GOTO 630
2020 REM 
2030 IF SGN(DA(4))<>-1 THEN 2060
2040 PRINT "SHIELDS ARE DAMAGED ";N$
2050 GOTO 630
2060 PRINT "SHIELDS AT";SH:"ENTER NEW POWER."
2070 INPUT "":SH
2080 IF SH>=0 THEN 2110
2090 PRINT "YOU CAN'T HAVE NEGATIVE     SHIELD, ";N$:"SHIELDS ARE SET AT ZERO."
2100 SH=0
2110 PRINT "DONE ";N$;".";"SHIELDS AT ";SH
2120 GOTO 3560
2130 REM 
2140 IF SGN(DA(5))<>-1 THEN 2170
2150 PRINT "PHASOR BANKS DAMAGED ";N$
2160 GOTO 630
2170 PRINT "PHASOR POWER AT";F
2180 PRINT "TYPE NEW POWER. (WARNING....VALUES OVER 10 MAY CAUSE    EXPLOSION OF SHIP WHEN FIRED"
2190 INPUT "":F
2200 IF F>0 THEN 2230
2210 PRINT "YOU CAN'T GO THAT LOW, THEY WOULD BE USELESS. PLEASE    RECONSIDER YOUR INPUT ";N$
2220 GOTO 2190
2230 PRINT "O.K. ";N$:"PHASORS AT ";F
2240 GOTO 3560
2250 REM  
2260 IF SGN(DA(5))=-1 THEN 2150
2270 WT=0
2280 MD=F
2290 P=P-F*2
2300 PRINT "WHAT DIRECTION ";N$;
2310 INPUT DD
2320 IF (DD>0)*(DD<10)THEN 2350
2330 PRINT "1 TO 9 PLEASE ";N$;"!"
2340 GOTO 2310
2350 IF (F<=10)+(RND>.8)+(WT=0)THEN 2380
2360 PRINT "PHASORS TOO POWERFULL!      EXPLOSION IMMEMENT!"
2370 GOTO 3340
2380 XX=X
2390 YY=Y
2400 NN=1
2410 XX=XX+XA(DD)
2420 CALL SOUND(100,550,0)
2430 YY=YY+YA(DD)
2440 IF (XX>0)*(XX<101)*(YY>0)*(YY<101)THEN 2470
2450 PRINT "SHOT OUT OF RANGE ";N$
2460 GOTO 3560
2470 FL=0
2480 FOR A=1 TO 20
2490 IF (EX(A)<>XX)+(EY(A)<>YY)THEN 2550
2500 PRINT "YOU GOT A DINGDON!"
2510 FL=1
2520 EX(A)=-1
2530 DL=DL-1
2540 A=51
2550 NEXT A
2560 IF FL=1 THEN 3560
2570 FOR A=1 TO 8
2580 IF (BX(A)<>XX)+(BY(A)<>YY)THEN 2630
2590 PRINT "YOU HIT A STARBASE!"
2600 FL=1
2610 A=9
2620 BX(A)=-1
2630 NEXT A
2640 IF FL=1 THEN 3560
2650 FOR A=1 TO 5
2660 IF (PX(A)<>XX)+(PY(A)<>YY)THEN 2720
2670 PRINT "THE SHOT HIT A PLANET."
2680 FL=1
2690 A=6
2700 IF WT=0 THEN 2720
2710 PX(A)=-1
2720 NEXT A
2730 IF FL=1 THEN 3560
2740 FOR A=1 TO 7
2750 IF (SX(A)<>XX)+(SY(A)<>YY)THEN 2790
2760 PRINT "THE SHOT HIT A SUN."
2770 FL=1
2780 A=8
2790 NEXT A
2800 IF FL=1 THEN 3560
2810 FOR A=1 TO 2
2820 IF (ABS(HX(A)-XX)>1)+(ABS(HY(A)-YY)>1)THEN 2860
2830 PRINT "THE SHOT WAS SUCKED IN BY A BLACK HOLE."
2840 FL=1
2850 A=3
2860 NEXT A
2870 IF FL=1 THEN 3560
2880 NN=NN+1
2890 IF NN<MD THEN 2410
2900 PRINT "THE SHOT DIDN'T HIT ANYTHING"
2910 GOTO 3560
2920 REM 
2930 IF SGN(DA(6))<>-1 THEN 2960
2940 PRINT "TORPEDO BAY DAMAGED ";N$
2950 GOTO 630
2960 WT=2
2970 IF T>0 THEN 3000
2980 PRINT "NO MORE TORPEDOS ";N$
2990 GOTO 630
3000 MD=31
3010 P=P-30
3020 T=T-1
3030 GOTO 2300
3040 REM 
3050 IR=0
3060 FOR A=1 TO 8
3070 IF (ABS(BX(A)-X)>1)+(ABS(BY(A)-Y)>1)THEN 3090
3080 IR=A
3090 NEXT A
3100 IF IR<>0 THEN 3250
3110 FOR A=1 TO 5
3120 IF (ABS(PX(A)-X)>1)+(ABS(PY(A)-Y)>1)THEN 3140
3130 IR=A
3140 NEXT A
3150 IF IR<>0 THEN 3180
3160 PRINT "NO BASE OR PLANET IN RANGE ";N$
3170 GOTO 630
3180 IF PS(IR)=1 THEN 3210
3190 PRINT "PLANET IS NO GOOD FOR       REFUELING ON."
3200 GOTO 630
3210 P=100000
3220 PRINT "POWER REFUELED ";N$
3230 PS(IR)=0
3240 GOTO 3560
3250 P=100000
3260 C=100
3270 T=50
3280 PRINT "COMPLETELY REFUELED ";N$
3290 GOTO 3560
3300 REM 
3310 PRINT "ARE YOU SURE YOU WANT TO    SELF-DESTRUCT ";N$;"?"
3320 INPUT A$
3330 IF SEG$(A$,1,1)<>"Y" THEN 630
3340 PRINT "     }BOOM{"
3350 FOR A=1 TO 20
3360 IF (ABS(EX(A)-X)>1)+(ABS(EY(A)-Y)>1)THEN 3390
3370 PRINT "DINGDON DESTROYED!"
3380 DL=DL-1
3390 NEXT A
3400 IF DL>0 THEN 4990 ELSE 4920
3410 REM 
3420 IF SGN(DA(7))<>-1 THEN 3450
3430 PRINT "COMMUNICATION IS OUT ";N$
3440 GOTO 630
3450 BB=0
3460 FOR A=1 TO 8
3470 IF BX(A)=-1 THEN 3490
3480 BB=A
3490 NEXT A
3500 IF BB<>0 THEN 3530
3510 PRINT "NO MORE STARBASES TO HELP   YOU ";N$
3520 GOTO 630
3530 TI=INT((ABS(BX(BB)-X)+ABS(BY(BB)-Y))/2)
3540 BX(BB)=-1
3550 PRINT "THE ENERGY BEAM WILL GET TO YOU IN";TI;"TURNS."
3560 FOR A=1 TO 8-SP
3570 XX=INT(RND*7)+1
3580 DA(XX)=DA(XX)+RND
3590 NEXT A
3600 P=P-SH-25*SP
3610 TI=TI-1
3620 IF TI<>0 THEN 3650
3630 PRINT "THE ENERGY BEAM HAS REACHED YOU ";N$
3640 P=100000
3650 FL=0
3660 FOR A=1 TO SP
3670 X=X+XA(D)
3680 Y=Y+YA(D)
3690 IF (X<100)*(X>1)*(Y<100)*(Y>1)THEN 3740
3700 PRINT "YOU ARE AT THE BOUNDARY"
3705 IF (X>0)*(X<101)THEN 3715
3710 X=-(X<2)-100*(X>99)
3715 IF (Y>0)*(Y<101)THEN 3730
3720 Y=-(Y<2)-100*(Y>99)
3730 GOTO 4110
3740 FOR B=1 TO 20
3750 IF (EX(B)<>X)+(EY(B)<>Y)THEN 3800
3760 PRINT "YOU RAMMED A DINGDON SHIP!  YOU'RE BOTH DESTROYED ";N$
3770 DL=DL-1
3780 FL=1
3790 B=51
3800 NEXT B
3810 IF FL=1 THEN 4110
3820 FOR B=1 TO 8
3830 IF (BX(B)<>X)+(BY(B)<>Y)THEN 3870
3840 PRINT "YOU RAMMED A STARBASE ";N$
3850 FL=1
3860 B=9
3870 NEXT B
3880 IF FL=1 THEN 4110
3890 FOR B=1 TO 5
3900 IF (PX(B)<>X)+(PY(B)<>Y)THEN 3940
3910 PRINT "YOU HIT A PLANET ";N$
3920 FL=1
3930 B=6
3940 NEXT B
3950 IF FL=1 THEN 4110
3960 FOR B=1 TO 7
3970 IF (SX(B)<>X)+(SY(B)<>Y)THEN 4010
3980 PRINT "YOU HIT A SUN!"
3990 FL=1
4000 B=8
4010 NEXT B
4020 IF FL=1 THEN 4110
4030 FOR B=1 TO 2
4040 IF (ABS(HX(B)-X)>1)+(ABS(HY(B)-Y)>1)THEN 4090
4050 IF (RND>=.1)*(SP=8)THEN 4090
4060 PRINT "YOU WERE SUCKED IN BY A     BLACK HOLE ";N$
4070 FL=1
4080 B=3
4090 NEXT B
4100 GOTO 4120
4110 A=SP+1
4120 NEXT A
4130 IF FL<>1 THEN 4150
4140 IF DL=0 THEN 4920 ELSE 4990
4150 PRINT "MOVE SUCCESSFUL"
4160 PRINT :"ENEMY MOVE:"
4170 FOR A=1 TO 20
4180 IF EX(A)=-1 THEN 4710
4190 IF (ABS(EX(A)-X)>5)+(ABS(EY(A)-Y)>5)THEN 4230
4200 EX(A)=EX(A)+SGN(X-EX(A))
4210 EY(A)=EY(A)+SGN(Y-EY(A))
4220 GOTO 4250
4230 EX(A)=EX(A)+INT(RND*3)-1
4240 EY(A)=EY(A)+INT(RND*3)-1
4250 IF (EX(A)<>X)+(EY(A)<>Y)THEN 4290
4260 PRINT "YOU WERE RAMMED BY A DINGDON"
4270 DL=DL-1
4280 GOTO 4140
4290 IF (EX(A)>0)*(EX(A)<101)*(EY(A)>0)*(EY(A)<101)THEN 4340
4300 PRINT "DINGDON AT BOUNDARY         DESTROYED ";N$
4310 EX(A)=-1
4320 DL=DL-1
4330 GOTO 4710
4340 FOR B=1 TO 20
4350 IF (EX(A)<>EX(B))+(EY(A)<>EY(B))+(A=B)THEN 4410
4360 PRINT "TWO DINGDONS COLLIDED!"
4370 EX(A)=-1
4380 EX(B)=-1
4390 DL=DL-2
4400 GOTO 4710
4410 NEXT B
4420 FOR B=1 TO 8
4430 IF (BX(B)<>EX(A))+(BY(B)<>EY(A))THEN 4490
4440 PRINT "A DINGDON HIT A STARBASE!"
4450 EX(A)=-1
4460 BX(B)=-1
4470 DL=DL-1
4480 GOTO 4710
4490 NEXT B
4500 FOR B=1 TO 5
4510 IF (PX(B)<>EX(A))+(PY(B)<>EX(A))THEN 4560
4520 PRINT "A DINGDON HIT A PLANET!"
4530 EX(A)=-1
4540 DL=DL-1
4550 GOTO 4710
4560 NEXT B
4570 FOR B=1 TO 7
4580 IF (SX(B)<>EX(A))+(SY(B)<>EY(A))THEN 4630
4590 PRINT "A DINGDON HIT A SUN!"
4600 EX(A)=-1
4610 DL=DL-1
4620 GOTO 4710
4630 NEXT B
4640 FOR B=1 TO 2
4650 IF (ABS(HX(B)-EX(A))>1)+(ABS(HY(B)-EY(B))>1)THEN 4700
4660 PRINT "DINGDON SUCKED IN BY BLACK  HOLE!"
4670 EX(A)=-1
4680 DL=DL-1
4690 GOTO 4710
4700 NEXT B
4710 NEXT A
4720 IF DL=0 THEN 4920
4730 FOR A=1 TO 20
4740 SD=ABS(EX(A)-X+EY(A)-Y)/2
4750 IF SD>7 THEN 4840
4760 PRINT "LASER FIRE!"
4770 DM=INT(RND*(8-SD))-INT(SH/(INT(RND*50)+1))
4780 PRINT "DAMAGE LEVEL";DM
4790 FOR B=1 TO DM
4800 XX=INT(RND*7)+1
4810 DA(XX)=DA(XX)-RND
4820 NEXT B
4830 P=P-INT(RND*DL)
4840 NEXT A
4850 IF DA(1)+DA(2)+DA(3)+DA(4)+DA(5)+DA(6)+DA(7)>-35 THEN 4880
4860 PRINT "TOO MUCH DAMAGE! YOUR SHIP  JUST EXPLODED ";N$
4870 IF DL=0 THEN 4920 ELSE 4990
4880 IF P>0 THEN 4910
4890 PRINT "POWER CRYSTALS HAVE GONE    DEAD. LIFE SUPPORT IS FADING";N$
4900 GOTO 4870
4910 IF DL=0 THEN 4920 ELSE 630
4920 REM 
4930 PRINT "CONGRATULATIONS ";N$;"!":"YOU DESTROYED ALL THE":"DINGDONS! PROMOTIONS ARE IN ORDER"
4940 INPUT "PLAY AGAIN (Y/N)? ":A$
4950 RESTORE
4960 IF A$="Y" THEN 150
4970 CALL CLEAR
4980 END
4990 REM 
5000 PRINT "YOU FAILED! THERE WERE STILL";DL;"DINGDONS LEFT!"
5010 PRINT "YOU WILL BE LUCKY IF YOU GETTHE RANK OF JANITOR ";N$;"!!!"
5020 PRINT : :
5030 GOTO 4940
6000 PRINT "WHICH ITEM, ";N$
6010 INPUT "(1-7)?":A
6015 A=INT(A)
6020 IF (A>7)+(A<1)THEN 6010
6030 FOR B=1 TO 8-SP
6040 DA(A)=DA(A)+RND
6050 NEXT B
6055 PRINT "O.K. ";N$
6060 GOTO 3600
7000 CALL HCHAR((Y/5)+2,(X/5)+5,97)
7005 P=P-50
7010 FOR A=1 TO 20
7020 IF EX(A)=-1 THEN 7040
7030 CALL HCHAR((EY(A)/5)+2,(EX(A)/5)+5,98)
7040 NEXT A
7050 FOR A=1 TO 8
7060 IF BX(A)=-1 THEN 7080
7070 CALL HCHAR((BY(A)/5)+2,(BX(A)/5)+5,100)
7080 NEXT A
7090 FOR A=1 TO 5
7100 IF PX(A)=-1 THEN 7120
7110 CALL HCHAR(PY(A)/5+2,PX(A)/5+5,101)
7120 NEXT A
7130 FOR A=1 TO 7
7150 CALL HCHAR(SY(A)/5+2,SX(A)/5+5,102)
7160 NEXT A
7170 FOR A=1 TO 2
7180 CALL HCHAR(HY(A)/5+2,HX(A)/5+5,103)
7190 NEXT A
7200 RETURN
